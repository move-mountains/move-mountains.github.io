<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Docker 入门 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Docker 入门参考文档：https:&#x2F;&#x2F;ruanyifeng.com&#x2F;blog&#x2F;2018&#x2F;02&#x2F;docker-tutorial.html主要目标是整明白 DockerFile 这个东西。 简介开源项目，基于 Go 语言，代码直接在 GitHub 上维护。目标是实现轻量级的操作系统虚拟化解决方案，基础是 Linux 容器（LXC）等技术。在 LXC 的基础上 Docker 进行了进一步的封装，让">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker 入门">
<meta property="og:url" content="http://move-mountains.github.io/2022/05/29/Docker/Docker%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Docker 入门参考文档：https:&#x2F;&#x2F;ruanyifeng.com&#x2F;blog&#x2F;2018&#x2F;02&#x2F;docker-tutorial.html主要目标是整明白 DockerFile 这个东西。 简介开源项目，基于 Go 语言，代码直接在 GitHub 上维护。目标是实现轻量级的操作系统虚拟化解决方案，基础是 Linux 容器（LXC）等技术。在 LXC 的基础上 Docker 进行了进一步的封装，让">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-05-29T15:18:51.000Z">
<meta property="article:modified_time" content="2022-05-29T15:19:09.300Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://move-mountains.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Docker/Docker入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/05/29/Docker/Docker%E5%85%A5%E9%97%A8/" class="article-date">
  <time class="dt-published" datetime="2022-05-29T15:18:51.000Z" itemprop="datePublished">2022-05-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Docker 入门
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Docker-入门"><a href="#Docker-入门" class="headerlink" title="Docker 入门"></a>Docker 入门</h1><p>参考文档：<a target="_blank" rel="noopener" href="https://ruanyifeng.com/blog/2018/02/docker-tutorial.html">https://ruanyifeng.com/blog/2018/02/docker-tutorial.html</a><br>主要目标是整明白 DockerFile 这个东西。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>开源项目，基于 Go 语言，代码直接在 GitHub 上维护。<br>目标是实现轻量级的操作系统虚拟化解决方案，基础是 Linux 容器（LXC）等技术。<br>在 LXC 的基础上 Docker 进行了进一步的封装，让用户不需要去关心容器的管理，简化操作。用户操作 Docker 的容器就像操作一个快速轻量级的虚拟机一样简单。</p>
<blockquote>
<p>简介：Docker是一个开源的引擎，可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署，包括VMs（虚拟机）、bare metal、OpenStack 集群和其他的基础应用平台。</p>
</blockquote>
<h3 id="相关扩展"><a href="#相关扩展" class="headerlink" title="相关扩展"></a>相关扩展</h3><h4 id="Linux-容器-Linux-Containers，缩写为-LXC"><a href="#Linux-容器-Linux-Containers，缩写为-LXC" class="headerlink" title="Linux 容器(Linux Containers，缩写为 LXC)"></a>Linux 容器(Linux Containers，缩写为 LXC)</h4><p>虚拟机的更简化的技术方案，与虚拟机一样，主要目的是做到<strong>带环境安装应用程序</strong>。在 windows 上运行 linux 系统，且应用程序毫无感知等。<br>虚拟机是模拟了一整个操作系统，会存在很多不需要的冗余，而 <strong>Linux 容器不是模拟一个完整的操作系统，只对进程进行隔离。</strong><br>容器内的进程只能接触到容器提供的各种资源，不能直接与底层系统交互，因此实现了与底层系统的隔离。<br>且 Linux 容器是进程级别的，相比虚拟机，它启动快，占用资源少，体积小。</p>
<h2 id="Docker-用途"><a href="#Docker-用途" class="headerlink" title="Docker 用途"></a>Docker 用途</h2><ul>
<li><strong>提供一次性的环境。</strong>比如，本地测试他人的软件、持续集成的时候提供单元测试和构建的环境。</li>
<li><strong>提供弹性的云服务。</strong>因为 Docker 容器可以随开随关，很适合动态扩容和缩容。</li>
<li><strong>组建微服务架构。</strong>通过多个容器，一台机器可以跑多个服务，因此在本机就可以模拟出微服务架构。</li>
</ul>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li><strong>镜像（Image）</strong>：类似于虚拟机中的镜像，是一个包含有文件系统的面向 Docker 引擎的只读模板。任何应用程序运行都需要环境，而镜像就是用来提供这种运行环境的。例如一个 Ubuntu 镜像就是一个包含 Ubuntu 操作系统环境的模板，同理在该镜像上装上 Apache 软件，就可以称为 Apache 镜像。</li>
<li><strong>容器（Container）</strong>：类似于一个轻量级的沙盒，可以将其看作一个极简的 Linux 系统环境（包括 root 权限、进程空间、用户空间和网络空间等），以及运行在其中的应用程序。Docker 引擎利用容器来运行、隔离各个应用。容器是镜像创建的应用实例，可以创建、启动、停止、删除容器，各个容器之间是是相互隔离的，互不影响。注意：镜像本身是只读的，容器从镜像启动时，Docker 在镜像的上层创建一个可写层，镜像本身不变。</li>
<li><strong>仓库（Repository）</strong>：类似于代码仓库，这里是镜像仓库，是 Docker 用来集中存放镜像文件的地方。注意与注册服务器（Registry）的区别：注册服务器是存放仓库的地方，一般会有多个仓库；而仓库是存放镜像的地方，一般每个仓库存放一类镜像，每个镜像利用tag进行区分，比如 Ubuntu 仓库存放有多个版本（12.04、14.04等）的Ubuntu镜像。</li>
</ul>
<p><strong>Docker 把应用程序及其依赖，打包在 image 文件里面。</strong>通过这个 image 文件，Docker 才能生成对应的容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。<br>image 本身是个二进制文件，且是通用的（一个制作好的 image 可以放到任意的 Docker 服务器里生成容器实例）。所以实际开发过程中，一般都是通过继承他人的 image，加上自己的个性化设置，生成自己的个性 image 文件。<br>而为了方便共享，制作完成的 image 也可以共享到网上，Docker 有官方的 image 仓库<a target="_blank" rel="noopener" href="https://hub.docker.com/">Docker Hub</a>。</p>
<h2 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h2><h3 id="修改镜像源"><a href="#修改镜像源" class="headerlink" title="修改镜像源"></a>修改镜像源</h3><p>直接取官方仓库的镜可能很慢，可以换成国内镜像站。<br>在<code>/etc/default/docker</code>文件末尾添加一行</p>
<p>有几个常用的国内镜像站。阿里云的还得专门申请，就不列了</p>
<ul>
<li>科大镜像：<a target="_blank" rel="noopener" href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a></li>
<li>网易：<a target="_blank" rel="noopener" href="https://hub-mirror.c.163.com/">https://hub-mirror.c.163.com</a></li>
<li>七牛云加速器：<a target="_blank" rel="noopener" href="https://reg-mirror.qiniu.com/">https://reg-mirror.qiniu.com</a></li>
<li>腾讯云镜像: <a target="_blank" rel="noopener" href="https://mirror.ccs.tencentyun.com/">https://mirror.ccs.tencentyun.com</a></li>
</ul>
<p>Ubuntu14.04 与 Ubuntu16.04+&#x2F;CentOS7 的操作似乎不一样，以下仅给出 CentOS 的操作方法。</p>
<p>CentOS7 需要编辑<code>/etc/docker/daemon.json</code>文件，没有则需要新建</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;&#123;&quot;registry-mirrors&quot;:[&quot;https://reg-mirror.qiniu.com/&quot;]&#125;&#x27; &gt;&gt;  /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DOCKER_OPTS=&quot;--registry-mirror=https://docker.mirrors.ustc.edu.cn&quot;</span><br></pre></td></tr></table></figure>

<p>修改后，需要重启 Docker 服务。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<blockquote>
<p>以上操作操作都需要 sudo 权限</p>
</blockquote>
<h4 id="检测镜像源的修改是否生效"><a href="#检测镜像源的修改是否生效" class="headerlink" title="检测镜像源的修改是否生效"></a>检测镜像源的修改是否生效</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info</span><br></pre></td></tr></table></figure>

<p>应当可以在末尾看到自己指定的镜像路径<code>Registry Mirrors:</code></p>
<h3 id="从远程获取镜像"><a href="#从远程获取镜像" class="headerlink" title="从远程获取镜像"></a>从远程获取镜像</h3><p>以 hello-world 镜像为例。<br>先查找镜像列表，查询仓库里名字中含有 hello-world 的镜像</p>
<blockquote>
<p>这个命令不是太好用，显示的不太全，只能稍微验证一下。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-16-4-centos ~]<span class="comment"># docker search hello-world</span></span><br><span class="line">NAME                                       DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">hello-world                                Hello World! (an example of minimal Dockeriz…   1703      [OK]       </span><br><span class="line">kitematic/hello-world-nginx                A light-weight nginx container that demonstr…   151                  </span><br><span class="line">tutum/hello-world                          Image to <span class="built_in">test</span> docker deployments. Has Apache…   88                   [OK]</span><br><span class="line">dockercloud/hello-world                    Hello World!                                    19                   [OK]</span><br><span class="line">crccheck/hello-world                       Hello World web server <span class="keyword">in</span> under 2.5 MB          15                   [OK]</span><br><span class="line">vad1mo/hello-world-rest                    A simple REST Service that echoes back all t…   5                    [OK]</span><br><span class="line">ansibleplaybookbundle/hello-world-db-apb   An APB <span class="built_in">which</span> deploys a sample Hello World! a…   2                    [OK]</span><br><span class="line">ppc64le/hello-world                        Hello World! (an example of minimal Dockeriz…   2                    </span><br><span class="line">rancher/hello-world                                                                        1                    </span><br><span class="line">ansibleplaybookbundle/hello-world-apb      An APB <span class="built_in">which</span> deploys a sample Hello World! a…   1                    [OK]</span><br><span class="line">souravpatnaik/hello-world-go               hello-world <span class="keyword">in</span> Golang                           1                    </span><br><span class="line">thomaspoignant/hello-world-rest-json       This project is a REST hello-world API to bu…   1                    </span><br><span class="line">strimzi/hello-world-consumer                                                               0                    </span><br><span class="line">strimzi/hello-world-producer                                                               0                    </span><br><span class="line">businessgeeks00/hello-world-nodejs                                                         0                    </span><br><span class="line">koudaiii/hello-world                                                                       0                    </span><br><span class="line">freddiedevops/hello-world-spring-boot                                                      0                    </span><br><span class="line">strimzi/hello-world-streams                                                                0                    </span><br><span class="line">garystafford/hello-world                   Simple hello-world Spring Boot service <span class="keyword">for</span> t…   0                    [OK]</span><br><span class="line">tsepotesting123/hello-world                                                                0                    </span><br><span class="line">armswdev/c-hello-world                     Simple hello-world C program on Alpine Linux…   0                    </span><br><span class="line">dandando/hello-world-dotnet                                                                0                    </span><br><span class="line">kevindockercompany/hello-world                                                             0                    </span><br><span class="line">okteto/hello-world                                                                         0                    </span><br><span class="line">rsperling/hello-world3                                                                     0                    </span><br></pre></td></tr></table></figure>

<p>拉取镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image pull hello-world</span><br></pre></td></tr></table></figure>

<p>拉取成功后，就可以在列表中看到自己的这个 hello-world 镜像。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-16-4-centos ~]<span class="comment"># docker image ls</span></span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    feb5d9fea6a5   6 months ago   13.3kB</span><br></pre></td></tr></table></figure>

<h3 id="从镜像生成容器"><a href="#从镜像生成容器" class="headerlink" title="从镜像生成容器"></a>从镜像生成容器</h3><p>镜像拉取下来还只是个镜像，需要运行这个镜像以生成容器实例。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container run hello-world</span><br></pre></td></tr></table></figure>

<p><code>docker container run &lt;镜像名&gt;</code>这个命令可以从 image 文件中生成一个容器实例，并直接运行。<br>若这个命令无法从本地获取到对应的镜像，它会直接从远程仓库拉取。</p>
<p>运行成功的输出如下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-16-4-centos ~]<span class="comment"># docker container run hello-world</span></span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">.......</span><br></pre></td></tr></table></figure>

<p>输出以上内容后，这个容器将自动关闭（容器关闭只是不再运行，并不意味着需要再次从镜像生成新容器，事实上再调用一次镜像，生成的是一个新的容器）。<br>有些用于提供服务的容器不会自动终止，而会一直运行，如操作系统类的镜像(Ubuntu)，对这种镜像生成的运行容器，需要用命令主动终止。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container <span class="built_in">kill</span> &lt;containID&gt;</span><br></pre></td></tr></table></figure>

<p>其中，<code>&lt;containID&gt;</code>可以从<code>docker container ls</code>命令中获取到。</p>
<h3 id="操作容器"><a href="#操作容器" class="headerlink" title="操作容器"></a>操作容器</h3><p>从 image 生成的容器，其本身也是个文件，即容器文件。关闭容器也不会直接删除容器文件，只是容器不处于运行状态。<br>可以通过以下命令查看存在的容器列表。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出本机正在运行的容器</span></span><br><span class="line">[root@VM-16-4-centos ~]<span class="comment"># docker container ls</span></span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[root@VM-16-4-centos ~]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出本机所有容器，包括终止运行的容器</span></span><br><span class="line">[root@VM-16-4-centos ~]<span class="comment"># docker container ls --all</span></span><br><span class="line">CONTAINER ID   IMAGE         COMMAND    CREATED          STATUS                      PORTS     NAMES</span><br><span class="line">e2bbd64392ed   hello-world   <span class="string">&quot;/hello&quot;</span>   11 minutes ago   Exited (0) 11 minutes ago             distracted_banzai</span><br><span class="line">d93fa7a3bbfd   hello-world   <span class="string">&quot;/hello&quot;</span>   14 hours ago     Exited (0) 14 hours ago               wizardly_shtern</span><br></pre></td></tr></table></figure>

<h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><p>有了 image 文件，也可以生成容器，下一个问题是：如何构建自己的 image。<br><strong>Dockerfile 就是用来配置 image 的文本文件。</strong><br>写完自己的 Dockerfile 后，需要使用<code>docker build</code>命令生成镜像。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://move-mountains.github.io/2022/05/29/Docker/Docker%E5%85%A5%E9%97%A8/" data-id="clc46vbl70002z8u554sp7mcr" data-title="Docker 入门" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/05/29/Docker/Dockerfile%E8%87%AA%E5%AE%9A%E4%B9%89image/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          DockerFile构建自己的image
        
      </div>
    </a>
  
  
    <a href="/2022/05/29/Docker/Docker%E5%AE%89%E8%A3%85/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Docker 安装</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/05/29/Docker/Docker%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Docker 的常用命令</a>
          </li>
        
          <li>
            <a href="/2022/05/29/Docker/Dockerfile%E8%87%AA%E5%AE%9A%E4%B9%89image/">DockerFile构建自己的image</a>
          </li>
        
          <li>
            <a href="/2022/05/29/Docker/Docker%E5%85%A5%E9%97%A8/">Docker 入门</a>
          </li>
        
          <li>
            <a href="/2022/05/29/Docker/Docker%E5%AE%89%E8%A3%85/">Docker 安装</a>
          </li>
        
          <li>
            <a href="/2022/05/29/%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/Java%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E6%BC%94%E5%8F%98/">Java 日志框架的简介与演变</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>